#!/bin/sh

# set python path for modules under test and test modules
# set config dir to test config
source $(dirname ${BASH_SOURCE[0]})/testenv.rc


# stop old daemons if they exist, capture all the output, we
# don't care if we called it an extra time
$QUILT_HOME/test/bin/quilt_stop.py   &> /dev/null
sleep 2

# start up quilt daemons
$QUILT_HOME/lib/quilt_registrar.py   start -l DEBUG
$QUILT_HOME/lib/quilt_qmd.py         start -l DEBUG
$QUILT_HOME/lib/quilt_smd.py         start -l DEBUG

# run the quilt tests, exit with same failure code
$QUILT_HOME/test/lib/quilt_test.py   -l DEBUG || exit $?


